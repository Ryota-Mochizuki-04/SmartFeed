# RSS LINE Notifier - プロジェクト概要・要件定義書

## 🎯 プロジェクト概要

### プロジェクト名

RSS LINE Notifier - Serverless RSS to LINE Notification System

### 目的

RSS フィードから新着記事を自動取得し、LINE メッセージとして定期配信するサーバーレスシステム。ユーザーは LINE を通じて RSS フィードの管理（追加・削除・確認）を行い、記事は美しいカルーセル形式で通知される。

### ターゲットユーザー

- 複数の RSS フィードを効率的に管理したい情報収集者
- LINE を日常的に使用するユーザー
- プログラミング、技術記事、エンタメ情報を定期的にチェックしたいユーザー

## 📋 機能要件

### 1. RSS 監視・通知機能（メイン機能）

- **定期実行**: EventBridge による定期実行（JST 12:30, 21:00）
- **RSS 解析**: feedparser ライブラリによる RSS フィード解析
- **新着フィルタ**: 24 時間以内の記事のみを対象とした新着判定
- **重複排除**: 通知履歴との照合による重複通知防止
- **カテゴリ分類**: 記事の自動カテゴリ分類とカルーセル表示
- **優先順位表示**: カテゴリ内の記事に 🥇🥈🥉 ランキング表示

### 2. LINE Webhook 機能（コマンド処理）

- **コマンド処理**: ユーザーからのテキストコマンドを解析・実行
- **Loading Animation**: 処理中の視覚的フィードバック
- **セキュリティ**: LINE 署名検証による不正アクセス防止
- **エラーハンドリング**: 包括的なエラー処理と適切なレスポンス

### 3. ユーザーコマンド

| コマンド      | 機能                      | 実行結果               |
| ------------- | ------------------------- | ---------------------- |
| `一覧`        | 登録済み RSS フィード表示 | 番号付きフィード一覧   |
| `追加 <URL>`  | RSS フィード追加          | フィード検証 →S3 保存  |
| `削除 <番号>` | RSS フィード削除          | 指定番号のフィード削除 |
| `通知`        | 手動通知実行              | Notifier Lambda 起動   |
| `ヘルプ`      | 使用方法表示              | コマンド一覧と使用例   |

### 4. インテリジェント記事分析システム（v2.1）

- **記事タイプ分類**: 🔥 トレンド、⚡ 技術解説、🛠️ ツール、📊 分析、📰 ニュース
- **難易度推定**: 初級・中級・上級の 3 段階判定
- **読了時間推定**: 記事長に基づく読了時間算出
- **優先順位スコア**: カテゴリ内でのランキング表示

## 🏗️ 非機能要件

### パフォーマンス要件

- **レスポンス時間**: LINE Webhook 5 秒以内の応答
- **処理時間**: RSS 通知処理 15 分以内での完了
- **同時実行**: Lambda 同時実行数制限（デフォルト 1000）

### 可用性要件

- **稼働率**: 99.9%以上（AWS Lambda の可用性に依存）
- **障害復旧**: 自動復旧機能（Lambda 自動リトライ）
- **監視**: CloudWatch Logs による監視・アラート

### セキュリティ要件

- **認証**: LINE Channel Secret による署名検証
- **暗号化**: S3 バケット暗号化（AES256）
- **アクセス制御**: IAM ロールによる最小権限原則
- **プライベートアクセス**: S3 バケットのパブリックアクセス完全遮断

### スケーラビリティ要件

- **フィード数**: 最大 100 フィード/ユーザー
- **記事数**: 最大 30 記事/通知（LINE API 制限）
- **ユーザー数**: 単一ユーザー向け設計（マルチユーザー拡張可能）

## 🎨 ユーザーインターフェース要件

### LINE Flex メッセージ設計

- **カルーセル形式**: カテゴリ別の横スクロール表示
- **記事表示**: タイトル、概要、画像、メタ情報
- **カテゴリヘッダー**: 件数、記事タイプ統計、日付表示
- **視覚的要素**: アイコン、色分け、グラデーション背景

### メッセージ制限

- **サイズ制限**: 50KB 未満（LINE API 制限）
- **記事数上限**: 30 件（400 エラー回避）
- **カルーセル上限**: 10 カテゴリ

## 🔄 システム連携要件

### 外部 API 連携

- **LINE Messaging API**: メッセージ送信・Webhook 受信
- **RSS Feeds**: feedparser による解析
- **画像取得**: HTTP/HTTPS による記事画像取得

### AWS サービス連携

- **Lambda**: サーバーレス実行環境
- **S3**: 設定・履歴データ永続化
- **EventBridge**: 定期実行スケジューリング
- **API Gateway**: Webhook エンドポイント
- **CloudWatch**: ログ・メトリクス監視

## ⚙️ 環境・技術要件

### 実行環境

- **Python**: 3.9+
- **AWS Region**: ap-northeast-1（東京）
- **Lambda Runtime**: python3.9

### 必須ライブラリ

```
boto3>=1.26.0
feedparser>=6.0.10
requests>=2.28.0
```

### 設定ファイル

- **RSS 設定**: `s3://bucket/rss-list.json`
- **通知履歴**: `s3://bucket/notified-history.json`
- **パラメータ**: CloudFormation parameters

## 📊 データ要件

### RSS 設定データ構造

```json
{
  "feeds": [
    {
      "url": "https://example.com/rss",
      "title": "Example Feed",
      "category": "プログラミング"
    }
  ]
}
```

### 通知履歴データ構造

```json
{
  "history": [
    {
      "title": "記事タイトル",
      "link": "https://example.com/article",
      "notified_at": "2024-01-01T12:00:00Z"
    }
  ]
}
```

## 🚀 デプロイメント要件

### インフラ要件

- **CloudFormation**: インフラのコード化
- **Lambda Deployment**: ZIP パッケージデプロイ
- **パラメータ管理**: 環境変数・SSM パラメータ

### CI/CD 要件

- **手動デプロイ**: スクリプトベースのパッケージ作成
- **バージョニング**: 関数名によるバージョン管理
- **ロールバック**: CloudFormation/Lambda 更新によるロールバック

## 📈 今後の拡張可能性

### 短期的拡張

- **マルチユーザー対応**: ユーザー ID 別設定管理
- **カテゴリカスタマイズ**: ユーザー定義カテゴリ
- **通知時間設定**: ユーザー指定の通知時間

### 長期的拡張

- **AI 要約機能**: GPT API による記事要約
- **コンテンツフィルタ**: キーワードベースフィルタリング
- **分析機能**: 読了率・エンゲージメント分析

## ✅ 受け入れ基準

### 機能テスト

- [ ] RSS フィード正常取得・解析
- [ ] LINE メッセージ送信成功
- [ ] Webhook コマンド正常動作
- [ ] エラーハンドリング適切性

### パフォーマンステスト

- [ ] 100 フィード処理時間 < 10 分
- [ ] Webhook 応答時間 < 5 秒
- [ ] メモリ使用量 < 512MB

### セキュリティテスト

- [ ] LINE 署名検証動作
- [ ] S3 アクセス制御確認
- [ ] IAM 権限最小化確認

この要件定義書は、Vibe Coding で RSS LINE Notifier システムを再実装する際の完全な仕様書として使用できます。
